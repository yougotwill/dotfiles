#!/bin/bash

# Edited by William Grant

# <xbar.title>Coinbase Prices</xbar.title>
# <xbar.version>v2.0</xbar.version>
# <xbar.author>Mustafa Türksavaş</xbar.author>
# <xbar.author.github>mustafaturksavas</xbar.author.github>
# <xbar.desc>Displays Coinbase exchange rates of USD for Oxen, Bitcoin, and Ethereum.</xbar.desc>
# <xbar.image>https://media.giphy.com/media/3oEhmKvAlkJHoqalFK/giphy.gif</xbar.image>
# <xbar.dependencies>bash, python3</xbar.dependencies>
#
# Based on Cryptocurrency Prices plugin by viiraj (github.com/viiraj).
#
# I hope this plugin provides value for you and if you feel like it, tips are always appreciated.
# Bitcoin: 19Nwwfn1bHviNXQ5st9eka6pVsWwpz7Kzz
# Ethereum: 0x8e8a7760cef2f3275b87d95ca4419a6fb1fc1300
# Litecoin: LVYrJcvdBmhazNoAtJhBvaSsyY2kWHwraJ

oxen_icon="iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAABbmlDQ1BpY2MAACiRdZE7SwNBFIW/JIaIRlIoIsFiCxWLBIKCWGosbIKEqGDUJtm8hDyW3QQRW8HGImAh2vgq/AfaCrYKgqAIIlb+AF+NhPVOEoiImWX2fpyZc5k5A85IXi9YHSEoFMtmbDasLcWXNc8rHvpx40dL6JYxHY1GaDu+7nGoehdUvdrv+3d0p9KWDo5O4QndMMvCU8KR9bKheEe4T88lUsJHwgFTDih8rfRkg18UZxv8odhciM2AU/XUsr84+Yv1nFkQHhUeKuQrevM86ibedHFxXqpf5iAWMWYJo5Gkwhp5ygSlFiWz/32hum+Oknh0+RtsYIojS068AVEr0jUtNSN6Wr48Gyr3v3lamfGxRndvGNzPtv0+DJ5dqFVt+/vYtmsn4HqCy2LLX5KcJj9Fr7a0oUPwbcH5VUtL7sHFNgw8GgkzUZdcMp2ZDLydQU8cem+ha6WRVXOd0wdY2JQnuoH9AxiR/b7VH9SPZ/a/dHVAAAAACXBIWXMAAAsTAAALEwEAmpwYAAAARElEQVQ4y2NgGAUDChixCfr5+f0npHHTpk2MRBlGyEBsBuE1DJeBuAwiaBi6gfgMIhoQE4ZUdxl9woxqsUluOhsFAwwAtmUh8oUUrhsAAAAASUVORK5CYII="
btc_icon="iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAABYlAAAWJQFJUiTwAAAFN2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDUgNzkuMTY0NTkwLCAyMDIwLzEyLzA5LTExOjU3OjQ0ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHRpZmY6T3JpZW50YXRpb249IjEiIHhtcDpDcmVhdGVEYXRlPSIyMDIxLTA1LTA2VDIzOjA4OjE0KzAzOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMS0wNS0wNlQyMzo1Nzo0NCswMzowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMS0wNS0wNlQyMzo1Nzo0NCswMzowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDplOTU3YjIzNi0yOTc4LTQ3OTgtYTk3Ni01NmMzMjcwNjg2MzkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6ZTk1N2IyMzYtMjk3OC00Nzk4LWE5NzYtNTZjMzI3MDY4NjM5IiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6ZTk1N2IyMzYtMjk3OC00Nzk4LWE5NzYtNTZjMzI3MDY4NjM5Ij4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZTk1N2IyMzYtMjk3OC00Nzk4LWE5NzYtNTZjMzI3MDY4NjM5IiBzdEV2dDp3aGVuPSIyMDIxLTA1LTA2VDIzOjU3OjQ0KzAzOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjIuMSAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6Tw0ZZAAAB20lEQVRYhe3Xu2tUQRTH8Q8xRsSITxKFFEI68YGdIuILQUvt7MVHEGzEP8DGQkGsLK0FxUYllSIW6tpYCDYKBiSSRvEtKmpx712vu3fCZnayN8X+4MBwznDOd+4Z7szQV+90Fd9zO5b7DpV8dztJMpgQaDGWtORdVPINdZJkICFQEi04oJiWrcKKCv9wabwGGzDSUmsIPyJqzqpL+BNpvzGF6zgiUYe6AWq1Z9hYTl73HtqK+/5vbbQGsRefta/8MnZgOw7gNO7IWlb1pS6kACo0WVHgZGDu4QBUo5iQomW/5jD3Fh5W+Jstq2MPfazwzRSDXgONYXeFf7IY9ApoDBN4jOUtsde4krLYbe2b9F1eaAofKuKFPcFoSpgQ0FysgYMLCaiwU/MJdA6rsVLWks04imv4GgD6hnXzBRT6McI43gSgTtTxH3qFi4HYeF2H69tQoC6gfQH/dIpLfkeX91zDOIvjgXgjFuiM7JWxFnsq4rtkm3QAy7AeW7ATSwM5X+BRDMyIdDfGwr7I7k5R2p8Y5im2FcljWrYpbh1NfcJL2UF7A/e6zGc0h2q1m/6t+nzumyj5Hgjvn6ZivtCM0oWqpPel8TSey95mhX7KjodZVfero019oL661V/WxN8R8ixZNAAAAABJRU5ErkJggg=="
eth_icon="iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAABYlAAAWJQFJUiTwAAAC/UlEQVRYw+WYX6gMcRTH997158GD/7Z7mzm/8/vN7KZNN1ohL+vBG+GmyN8Hrrh0S3nQxQPPIg9S8i9SJEUePVGKuOF6Q0qkkD9JQv6M7xmzzO6dXcvO7JJbp+bOTr/zmXO+55zfb1Ke56X+Jkv980D1/GnS8zXRPFy21/N8okDGmEnG5luOUjsN8/qWAznERx2bHgqQo/jl5M7O8S0DcpWaBYivISDPKHWoVUDtABgQiDCQAGaZZzYdCJHYEABUAokN1BJ47ECiE9FLDSBPK9XbNCA4Oxh2HgUEe5XryE1IHMjYZjqcfakDCPf5SNJAbYbo2lDHVYAgcKnExIBcorURTmsBedrmm5UCjwWIiMZiPDyPdEp8Drpajut3kcBEm2IHMor3l785fQTEcehkAaLTD1ukLLUM9/phjyu09Np13YmxAWWVmoqFPwfpeSrpQbQWoxdd8AUeThnR3Sxxn8O8GjPu6s8o8bG4gNqw4BV/gGrdA0frAHD7lxpCVAC8G88vBMwpiShgZzcMlCPSkg7YLjh+9ruilsgC7IxjYQ3mpQ0DyRvi7T5UcVYPUNhOgifdsIZc5iLCPfinQBD5W6R8az6fH9F4hBzHDrSYRpPbWDbD6miMSNcJtIwOf+8UrNUQkCyGijoPmGmymGVZ4yDSAz+qriqQulHq0thVjsb/+1zSK2Mpe7xlt5S3DNXSwNRad2GMXBoCBOHjuTVSnWJyHRTD2bgb4+HSFEeE+iSFfhpsXgKwywDaZoj3SDT83oVNGu5d/76L5CcS2ViBujKZUXBwL5SSO7A58lsxVRwmFkQuI03Q39oGOsKpZG4iwxXOZiAFn8JakR6DqFChUBgOwC1oEW/Kfifem+x+iHhHRFnfB8z2iKE6iBk2MukdY1pGSR2j472xzJSmbGGVUlyWmgggpHJzU08dEO6q6kDqYlD2zT0oomGergTSil+UOnPTgZC6MYB6VHFy7W7t2R69CFF54H9sQPNs+ceG4JzWi0itkOaZONB/9wXtG+MF7xgwhWr8AAAAAElFTkSuQmCC"

oxen_price=$(curl "https://api.coinbase.com/v2/exchange-rates?currency=OXEN" | python3 -c "import sys, json; print(json.load(sys.stdin)['data']['rates']['USD'])")
btc_price=$(curl "https://api.coinbase.com/v2/exchange-rates?currency=BTC" | python3 -c "import sys, json; print(json.load(sys.stdin)['data']['rates']['USD'])")
eth_price=$(curl "https://api.coinbase.com/v2/exchange-rates?currency=ETH" | python3 -c "import sys, json; print(json.load(sys.stdin)['data']['rates']['USD'])")

echo "$oxen_price | templateImage=$oxen_icon"
echo "---"
echo "$btc_price | templateImage=$btc_icon"
echo "$eth_price | templateImage=$eth_icon"
